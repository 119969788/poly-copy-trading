# 切换到真实交易模式指南

## ⚠️ 重要警告

切换到真实交易模式后，脚本将使用**真实资金**进行交易。请务必：

1. ✅ **充分测试模拟模式** - 在模拟模式下运行足够长的时间，确认一切正常
2. ✅ **检查钱包余额** - 确保钱包中有足够的 USDC.e 余额
3. ✅ **理解风险** - 了解自动跟单的风险，可能产生亏损
4. ✅ **检查参数** - 确认风险控制参数符合您的风险承受能力
5. ✅ **监控交易** - 切换到真实模式后，密切关注交易情况

## 当前风险控制参数

- **sizeScale**: 0.2（跟随 20% 规模）
- **maxSizePerTrade**: 100 USDC（最大单笔 $100）
- **maxSlippage**: 0.05（最大滑点 5%）
- **orderType**: FOK（Fill or Kill，完全成交或取消）
- **minTradeSize**: 1 USDC（最小交易 $1）

如需修改这些参数，请编辑 `src/index.ts` 文件。

## 切换到真实交易模式

### 方法 1：修改 .env 文件（推荐）

1. 打开 `.env` 文件

2. 找到或添加以下行：
   ```env
   DRY_RUN=false
   ```

3. 或者删除 `DRY_RUN` 行（如果不存在，默认是 false）

4. 保存文件

完整 `.env` 文件示例：
```env
POLYMARKET_PRIVATE_KEY=你的真实私钥
DRY_RUN=false
```

### 方法 2：使用命令行（Linux/Mac）

```bash
# 编辑 .env 文件
nano .env
# 或
vi .env

# 使用 sed 命令直接修改
sed -i 's/DRY_RUN=true/DRY_RUN=false/g' .env
```

### 方法 3：使用 PowerShell（Windows）

```powershell
# 读取文件内容
$content = Get-Content .env

# 替换 DRY_RUN 设置
$content = $content -replace 'DRY_RUN=true', 'DRY_RUN=false'

# 如果不存在，添加一行
if ($content -notmatch 'DRY_RUN') {
    $content += "DRY_RUN=false"
}

# 保存文件
$content | Set-Content .env
```

## 验证配置

切换后，运行脚本时应该看到：

```
📋 配置信息：
   模式: 💰 实盘模式  ← 这里应该显示"实盘模式"而不是"模拟模式"
```

如果还是显示"模拟模式"，请检查 `.env` 文件是否正确设置。

## 切换回模拟模式

如果需要在测试或遇到问题时切换回模拟模式：

```env
DRY_RUN=true
```

## 安全建议

### 1. 首次切换到真实模式

- ✅ 先运行几分钟观察
- ✅ 检查交易是否正确执行
- ✅ 确认金额符合预期
- ✅ 监控日志中的错误

### 2. 定期检查

- ✅ 定期查看交易日志
- ✅ 检查钱包余额
- ✅ 监控跟单表现
- ✅ 评估是否需要调整参数

### 3. 风险控制

- ✅ 设置合理的最大单笔金额
- ✅ 不要使用超过您能承受损失的资金
- ✅ 考虑设置每日/每周交易限额
- ✅ 定期审查跟单策略

### 4. 紧急停止

如果需要立即停止交易：

**使用 PM2：**
```bash
pm2 stop poly-copy-trading
```

**使用 nohup：**
```bash
ps aux | grep "tsx src/index.ts"
kill <进程ID>
```

**前台运行：**
按 `Ctrl+C`

## 常见问题

### Q: 如何知道当前是模拟模式还是真实模式？

A: 查看启动日志，会显示：
- `🔍 模拟模式 (Dry Run)` - 模拟模式
- `💰 实盘模式` - 真实模式

### Q: 切换后需要重启应用吗？

A: 是的，需要重启应用才能应用新的配置。

```bash
# PM2
pm2 restart poly-copy-trading

# nohup（需要停止后重新启动）
ps aux | grep "tsx"
kill <PID>
nohup pnpm start > output.log 2>&1 &
```

### Q: 真实模式下会有什么不同？

A:
- 模拟模式：只记录和显示交易，不执行真实交易
- 真实模式：会真实执行交易，使用真实资金

### Q: 可以同时运行模拟和真实模式吗？

A: 不建议。应该选择一种模式运行。如果想对比，可以在不同时间运行或使用不同的配置。

## 交易监控

切换到真实模式后，建议：

1. **实时监控日志**
   ```bash
   pm2 logs poly-copy-trading
   ```

2. **检查交易记录**
   - 查看日志中的每笔交易
   - 确认交易金额和方向
   - 检查交易状态（成功/失败）

3. **监控钱包余额**
   - 定期检查钱包 USDC.e 余额
   - 确保有足够资金继续交易

4. **评估表现**
   - 跟踪跟单表现
   - 评估是否达到预期
   - 考虑调整参数或策略

---

**记住：交易有风险，投资需谨慎！**
