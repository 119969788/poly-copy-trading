# 🔧 环境变量配置说明

## 📋 配置文件

项目使用 `.env` 文件存储配置。请复制 `env.example.txt` 或 `.env.example` 为 `.env` 并填写实际值。

---

## 🔑 必需配置

### 1. POLYMARKET_PRIVATE_KEY（必需）

Polymarket 钱包私钥。

```env
POLYMARKET_PRIVATE_KEY=your_private_key_here
```

**注意**：
- 可以包含或不包含 `0x` 前缀
- 不要将此文件提交到 Git

---

## 🔐 API 凭证配置

### 生成 API 凭证

1. **先设置私钥**：在 `.env` 文件中设置 `POLYMARKET_PRIVATE_KEY`

2. **运行生成脚本**：
   ```bash
   npm run generate-api-clob
   ```

3. **更新 .env 文件**：将生成的凭证添加到 `.env` 文件

```env
POLYMARKET_API_KEY=生成的api_key
POLYMARKET_API_SECRET=生成的secret
POLYMARKET_API_PASSPHRASE=生成的passphrase
```

---

## ⚙️ 服务器配置

### POLYMARKET_HOST

Polymarket API 服务器地址。

```env
POLYMARKET_HOST=https://clob.polymarket.com
```

### CHAIN_ID

区块链网络 ID。

```env
CHAIN_ID=137  # Polygon 主网
```

---

## 🔐 签名类型配置

### SIGNATURE_TYPE

签名类型，根据你的钱包类型选择：

| 值 | 类型 | 说明 |
|---|------|------|
| 0 | EOA | 使用 EOA 钱包，自己支付 Gas |
| 1 | POLY_PROXY | 使用 Polymarket.com 账户（Magic Link/Google） |
| 2 | GNOSIS_SAFE | 使用 Polymarket.com 账户（浏览器钱包） |

```env
SIGNATURE_TYPE=0
```

### FUNDER_ADDRESS

资金地址。

- 对于 EOA（类型 0）：使用你的钱包地址
- 对于代理钱包（类型 1 或 2）：使用代理钱包地址

```env
FUNDER_ADDRESS=your_wallet_address_here
```

---

## 🎯 跟随地址配置

### TARGET_ADDRESSES（可选）

指定要跟随的钱包地址。

- **不设置**：跟随排行榜前 50 名
- **设置**：只跟随指定的地址

```env
# 单个地址
TARGET_ADDRESSES=0x1234567890abcdef1234567890abcdef12345678

# 多个地址（逗号分隔，无空格）
TARGET_ADDRESSES=0x1234567890abcdef1234567890abcdef12345678,0xabcdef1234567890abcdef1234567890abcdef12
```

**重要**：
- 多个地址用逗号分隔
- **不要有空格**
- 地址必须以 `0x` 开头

---

## 🧪 模拟模式

### DRY_RUN

是否启用模拟模式。

```env
DRY_RUN=true   # 模拟模式（不实际交易）
DRY_RUN=false  # 实盘模式（实际交易）
```

**默认**：`true`（模拟模式）

---

## 📡 MCP 服务器配置（可选）

### MCP_ENDPOINT

MCP 服务器端点地址。

```env
MCP_ENDPOINT=http://localhost:3000
```

---

## 💹 交易配置（可选）

### MAX_POSITION_SIZE

最大持仓大小。

```env
MAX_POSITION_SIZE=100
```

### MIN_PROFIT_MARGIN

最小利润率（0.02 = 2%）。

```env
MIN_PROFIT_MARGIN=0.02
```

### CHECK_INTERVAL

检查间隔（毫秒）。

```env
CHECK_INTERVAL=30000  # 30 秒
```

---

## 🛡️ 风险管理配置（可选）

### MAX_DAILY_LOSS

最大每日亏损（USDC）。

```env
MAX_DAILY_LOSS=1000
```

### MAX_POSITIONS

最大持仓数量。

```env
MAX_POSITIONS=10
```

---

## 📝 完整配置示例

```env
# 必需：私钥
POLYMARKET_PRIVATE_KEY=0x851f2c1195f774117d0a63eed9bfa5ba3a9231d4a4caabeee3561585d1d238de

# API 凭证（运行 npm run generate-api-clob 生成）
POLYMARKET_API_KEY=your_api_key_here
POLYMARKET_API_SECRET=your_api_secret_here
POLYMARKET_API_PASSPHRASE=your_api_passphrase_here

# 服务器配置
POLYMARKET_HOST=https://clob.polymarket.com
CHAIN_ID=137

# 签名类型（0=EOA, 1=POLY_PROXY, 2=GNOSIS_SAFE）
SIGNATURE_TYPE=0
FUNDER_ADDRESS=your_wallet_address_here

# 跟随地址（可选，不设置则跟随排行榜）
# TARGET_ADDRESSES=0x1234...,0x5678...

# 模拟模式
DRY_RUN=true

# 交易配置（可选）
# MAX_POSITION_SIZE=100
# MIN_PROFIT_MARGIN=0.02
# CHECK_INTERVAL=30000

# 风险管理（可选）
# MAX_DAILY_LOSS=1000
# MAX_POSITIONS=10
```

---

## 🔐 安全提示

1. **不要提交 .env 文件到 Git**
   - `.env` 文件已在 `.gitignore` 中
   - 使用 `.env.example` 作为模板

2. **保护私钥和 API 凭证**
   - 不要分享给他人
   - 不要在公共场合显示
   - 定期轮换凭证

3. **文件权限**
   ```bash
   # Linux/Mac
   chmod 600 .env
   
   # Windows
   # 右键 .env 文件 → 属性 → 安全 → 编辑权限
   ```

---

## 🆘 故障排查

### 问题 1：找不到 .env 文件

**解决**：复制 `env.example.txt` 或 `.env.example` 为 `.env`

```bash
# Windows PowerShell
Copy-Item env.example.txt .env

# Linux/Mac
cp env.example.txt .env
```

### 问题 2：API 凭证未生成

**解决**：
1. 确保已设置 `POLYMARKET_PRIVATE_KEY`
2. 运行 `npm run generate-api-clob`
3. 将生成的凭证添加到 `.env` 文件

### 问题 3：配置不生效

**解决**：
1. 检查 `.env` 文件格式（无多余空格）
2. 重启应用
3. 检查环境变量是否正确加载

---

## ⚡ 快速配置步骤

1. **复制示例文件**：
   ```bash
   Copy-Item .env.example .env
   ```

2. **编辑 .env 文件**，设置：
   - `POLYMARKET_PRIVATE_KEY`（必需）

3. **生成 API 凭证**：
   ```bash
   npm run generate-api-clob
   ```

4. **更新 .env 文件**，添加生成的 API 凭证

5. **配置其他选项**（可选）

6. **重启应用**

---

## 📚 相关文档

- [生成 API 凭证指南](./生成API凭证指南.md)
- [只跟随指定地址](./只跟随指定地址.md)
