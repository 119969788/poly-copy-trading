# 🔄 更改跟随地址指南

## 📋 方法说明

跟随地址通过 `.env` 文件中的 `TARGET_ADDRESSES` 环境变量配置。

---

## 🔧 方法 1：修改本地 .env 文件

### 步骤：

1. **打开 `.env` 文件**（在项目根目录）

2. **添加或修改 `TARGET_ADDRESSES`**：

```env
# 单个地址
TARGET_ADDRESSES=0x1234567890abcdef1234567890abcdef12345678

# 多个地址（用逗号分隔）
TARGET_ADDRESSES=0x1234567890abcdef1234567890abcdef12345678,0xabcdef1234567890abcdef1234567890abcdef12,0x9876543210fedcba9876543210fedcba98765432
```

3. **保存文件**

4. **重启应用**（如果正在运行）：
   ```bash
   # 如果使用 PM2
   pm2 restart poly-copy-trading
   
   # 如果直接运行
   # 按 Ctrl+C 停止，然后重新运行
   pnpm start
   ```

---

## 🔧 方法 2：在服务器上修改

### 步骤：

1. **连接到服务器**：
   ```bash
   ssh root@你的服务器IP
   ```

2. **进入项目目录**：
   ```bash
   cd /root/poly-copy-trading
   # 或
   cd /root/projects/poly-copy-trading
   ```

3. **编辑 .env 文件**：
   ```bash
   nano .env
   ```

4. **修改或添加 `TARGET_ADDRESSES`**：
   ```env
   # 单个地址
   TARGET_ADDRESSES=0x1234567890abcdef1234567890abcdef12345678
   
   # 多个地址（用逗号分隔，不要有空格）
   TARGET_ADDRESSES=0x1234...,0x5678...,0x9abc...
   ```

5. **保存**：`Ctrl+O` → `Enter` → `Ctrl+X`

6. **重启 PM2 进程**：
   ```bash
   pm2 restart poly-copy-trading
   ```

7. **验证配置**：
   ```bash
   pm2 logs poly-copy-trading --lines 20
   ```
   
   应该看到类似输出：
   ```
   指定地址数量: 3
   目标地址: 0x1234..., 0x5678..., 0x9abc...
   ```

---

## 📝 配置示例

### 示例 1：跟随单个地址

```env
POLYMARKET_PRIVATE_KEY=your_private_key
TARGET_ADDRESSES=0x1234567890abcdef1234567890abcdef12345678
DRY_RUN=true
```

### 示例 2：跟随多个地址

```env
POLYMARKET_PRIVATE_KEY=your_private_key
TARGET_ADDRESSES=0x1234567890abcdef1234567890abcdef12345678,0xabcdef1234567890abcdef1234567890abcdef12,0x9876543210fedcba9876543210fedcba98765432
DRY_RUN=true
```

### 示例 3：跟随排行榜（不指定地址）

```env
POLYMARKET_PRIVATE_KEY=your_private_key
# TARGET_ADDRESSES=  # 注释掉或删除这一行
DRY_RUN=true
```

---

## ⚠️ 重要提示

1. **地址格式**：
   - 地址必须以 `0x` 开头
   - 多个地址用**逗号分隔**，**不要有空格**
   - 地址长度通常是 42 个字符（0x + 40 个十六进制字符）

2. **地址分隔**：
   ```env
   # ✅ 正确（逗号分隔，无空格）
   TARGET_ADDRESSES=0x1234...,0x5678...,0x9abc...
   
   # ❌ 错误（有空格）
   TARGET_ADDRESSES=0x1234..., 0x5678..., 0x9abc...
   ```

3. **重启应用**：
   - 修改 `.env` 文件后，必须重启应用才能生效
   - 如果使用 PM2，使用 `pm2 restart poly-copy-trading`
   - 如果直接运行，需要停止后重新启动

4. **验证配置**：
   - 启动后查看日志，确认跟随的地址是否正确
   - 日志会显示：`指定地址数量: X` 或 `跟随排行榜: 前 50 名`

---

## 🔍 验证配置

### 查看当前配置

在服务器上执行：

```bash
# 查看 .env 文件中的配置
cat .env | grep TARGET_ADDRESSES

# 查看应用日志（应该显示配置的地址）
pm2 logs poly-copy-trading --lines 30 | grep -A 5 "配置信息"
```

### 查看跟随的地址

应用启动时会打印配置信息，包括：
- 如果设置了 `TARGET_ADDRESSES`：显示 `指定地址数量: X` 和地址列表
- 如果没有设置：显示 `跟随排行榜: 前 50 名`

---

## 🔄 快速切换

### 从排行榜切换到指定地址

```bash
# 编辑 .env
nano .env

# 添加或修改
TARGET_ADDRESSES=0x你的地址1,0x你的地址2

# 重启
pm2 restart poly-copy-trading
```

### 从指定地址切换到排行榜

```bash
# 编辑 .env
nano .env

# 删除或注释掉 TARGET_ADDRESSES 行
# TARGET_ADDRESSES=...

# 重启
pm2 restart poly-copy-trading
```

---

## 📚 相关文件

- 主程序：`src/index.ts` - 读取 `TARGET_ADDRESSES` 环境变量
- 环境变量示例：`env.example.txt`
- 配置文件：`.env`（需要自己创建）

---

## 🆘 常见问题

### Q: 修改后没有生效？

A: 确保：
1. 文件已保存
2. 已重启应用（`pm2 restart poly-copy-trading`）
3. 地址格式正确（0x 开头，逗号分隔，无空格）

### Q: 如何添加更多地址？

A: 在 `TARGET_ADDRESSES` 中用逗号继续添加：
```env
TARGET_ADDRESSES=0x地址1,0x地址2,0x地址3,0x地址4
```

### Q: 如何移除所有指定地址，改回排行榜？

A: 删除或注释掉 `TARGET_ADDRESSES` 行：
```env
# TARGET_ADDRESSES=...
```

---

## ⚡ 快速命令

```bash
# 编辑 .env 文件
nano .env

# 重启应用
pm2 restart poly-copy-trading

# 查看日志验证
pm2 logs poly-copy-trading --lines 20
```
